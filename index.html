<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>GrokBot</title>
    <base href="/grokbot/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="GrokBot.styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css" integrity="sha512-UyNhw5RNpQaCai2EdC+Js0QL4RlVmiq41DkmCJsRV3ZxipG2L0HhTqIf/H9Hp8ez2EnFlkBnjRGJU2stW3Lj+w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div id="app">
        <div class="loading-container">
            <div class="loading-text">
                <h1>GrokBot</h1>
                <p>è½½å…¥ä¸­...</p>
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <div id="blazor-error-ui">
        å‘ç”Ÿäº†ä¸€ä¸ªæœªå¤„ç†çš„é”™è¯¯ã€‚
        <a href="" class="reload">é‡æ–°åŠ è½½</a>
        <a class="dismiss">ğŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
        // ä¿®å¤è·¯ç”±å¤„ç†ï¼Œé¿å…404é”™è¯¯
        window.addEventListener('load', function() {
            // ç›‘å¬æ‰€æœ‰é“¾æ¥ç‚¹å‡»ï¼Œç¡®ä¿è·¯ç”±æ­£ç¡®å¤„ç†
            document.addEventListener('click', function(e) {
                // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»äº†aæ ‡ç­¾
                const anchor = e.target.closest('a');
                if (!anchor) return;
                
                // æ£€æŸ¥æ˜¯å¦æ˜¯å†…éƒ¨é“¾æ¥
                const href = anchor.getAttribute('href');
                if (!href || href.startsWith('http') || href.startsWith('//') || href.startsWith('#')) return;
                
                console.log('æ•è·é“¾æ¥ç‚¹å‡»: ' + href);
                
                // è·å–å½“å‰baseè·¯å¾„
                const base = document.querySelector('base').getAttribute('href') || '/';
                
                // åœ¨GitHub Pagesç¯å¢ƒä¸‹é‡å†™é“¾æ¥
                if (window.location.hostname.includes('github.io')) {
                    e.preventDefault();
                    const newHref = base + href.replace(/^\//, '');
                    console.log('é‡å†™é“¾æ¥: ' + newHref);
                    window.location.href = newHref;
                }
            });
        });

        // ä¿å­˜/æ¢å¤èŠå¤©å†…å®¹çš„åŠŸèƒ½å¢å¼º
        window.saveChatToLocalStorage = function(chatId, messages) {
            try {
                localStorage.setItem('chat_' + chatId, JSON.stringify(messages));
                console.log('å·²ä¿å­˜èŠå¤©: ' + chatId);
                return true;
            } catch (e) {
                console.error('ä¿å­˜èŠå¤©å‡ºé”™: ', e);
                return false;
            }
        };

        window.loadChatFromLocalStorage = function(chatId) {
            try {
                const data = localStorage.getItem('chat_' + chatId);
                if (data) {
                    console.log('å·²åŠ è½½èŠå¤©: ' + chatId);
                    return JSON.parse(data);
                }
                return null;
            } catch (e) {
                console.error('åŠ è½½èŠå¤©å‡ºé”™: ', e);
                return null;
            }
        };

        // ä¿®å¤ScrollToBottomåŠŸèƒ½
        window.scrollToBottom = function(elementId) {
            try {
                const element = document.getElementById(elementId);
                if (element) {
                    element.scrollTop = element.scrollHeight;
                }
            } catch (e) {
                console.error('æ»šåŠ¨åˆ°åº•éƒ¨å‡ºé”™: ', e);
            }
        };
    </script>
</body>

</html>
